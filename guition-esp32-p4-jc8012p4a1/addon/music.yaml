# =============================================================================
# MUSIC DASHBOARD - HTTP request, album art image
# =============================================================================
# Required for online_image (album art from Home Assistant entity_picture).
# Placeholder image shown until art is downloaded.
# =============================================================================

http_request:
  id: http_req

image:
  - file: "https://placehold.co/800x800/2d2d2d/555555"
    id: album_art_placeholder
    type: RGB565
    byte_order: little_endian

online_image:
  - url: "https://placehold.co/800x800/2d2d2d/555555"
    id: album_art_background
    type: RGB565
    byte_order: little_endian
    format: jpeg
    placeholder: album_art_placeholder
    resize: 800x800
    on_download_finished:
      - lvgl.widget.hide: artwork_error_label
      - lambda: |-
          auto *w = id(album_art_background_widget);
          lv_img_set_zoom(w, 256);
          lv_img_set_offset_x(w, 0);
          lv_img_set_offset_y(w, 0);
          lv_obj_set_size(w, 800, 800);
          lv_obj_set_pos(w, 0, 0);
      - lvgl.image.update:
          id: album_art_background_widget
          src: album_art_background
      - lvgl.widget.update:
          id: album_art_background_widget
          opa: 100%
    on_error:
      - lvgl.widget.update:
          id: album_art_background_widget
          opa: 40%
      - lvgl.widget.show: artwork_error_label
